(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/auth/passwordLogin"],{"1e1b":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n("a34a"));function u(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r,u,o,a){try{var i=e[o](a),s=i.value}catch(c){return void n(c)}i.done?t(s):Promise.resolve(s).then(r,u)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,u){var a=e.apply(t,n);function i(e){o(a,r,u,i,s,"next",e)}function s(e){o(a,r,u,i,s,"throw",e)}i(void 0)}))}}var i={data:function(){return{userObj:{},userToken:{},form:{email:"",password:""},rules:{email:[{required:!0,whitespace:!0,pattern:/^\w+@{1}\w{0,20}(.(com|cn)){1,}$/gi,message:"请输入正确的邮箱",trigger:["change","blur"]}],password:[{required:!0,min:6,whitespace:!0,message:"密码最少6位",trigger:["change","blur"]}]}}},onReady:function(){this.$refs.uForm.setRules(this.rules)},computed:{inputStyle:function(){var e={};return this.form.email&&(this.form.password+"").length>=6&&(e.color="#fff",e.backgroundColor=this.$u.color["warning"]),e}},methods:{submit:function(){var t=this;return a(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$refs.uForm.validate(function(){var n=a(r.default.mark((function n(u){var o,a,i,s;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(u){n.next=4;break}e.showToast({title:"验证失败",icon:"none"}),n.next=15;break;case 4:if(o=t.form,a=o.email,i=o.password,!(t.$u.test.email(a)&&(i+"").length>=6)){n.next=10;break}s={email:a,password:i},t.$u.post("/api/auth/login",s).then((function(e){}),(function(n){var r=t;t.userToken=n,t.$bus.userToken=n,t.$u.http.interceptor.request=function(e){return e.header.Authorization=r.$bus.userToken.token_type+" "+r.$bus.userToken.access_token,"/api/auth/login"==e.url&&(e.header.noToken=!0),e},e.setStorageSync("uni-shop-userToken",JSON.stringify(n)),t.$u.get("/api/user",{}).then((function(e){}),(function(n){e.setStorageSync("uni-shop-userObj",JSON.stringify(n)),t.userObj=n,t.$bus.userObj=n;var r=n.data?"邮箱或密码不正确":"微信小程序登陆成功",u=n.data?"error":"success";t.showToast({title:r,type:u}),n.data||setTimeout((function(){t.toIndex("pages/index/index")}),1500)}))})),n.next=15;break;case 10:if(t.form.email.length&&(t.form.password+"").length>=6){n.next=14;break}return n.abrupt("return");case 14:t.showToast({title:"邮箱错误",type:"error"});case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)})))()},toIndex:function(e){this.$u.route({type:"switchTab",url:e})},toUrl:function(e){this.$u.route({url:e,type:"reLaunch"})},showToast:function(e){var t=e.title,n=e.type;this.$refs.uToast.show({title:t,type:n})}}};t.default=i}).call(this,n("543d")["default"])},"4f0f":function(e,t,n){"use strict";var r=n("a34c"),u=n.n(r);u.a},"8eb7":function(e,t,n){"use strict";n.r(t);var r=n("1e1b"),u=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=u.a},"9b32":function(e,t,n){"use strict";(function(e){n("6f4b");r(n("66fd"));var t=r(n("d832"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},a34c:function(e,t,n){},bb36:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var r={uForm:function(){return n.e("components/u-form/u-form").then(n.bind(null,"5090"))},uFormItem:function(){return Promise.all([n.e("common/vendor"),n.e("components/u-form-item/u-form-item")]).then(n.bind(null,"7025"))},uToast:function(){return n.e("components/u-toast/u-toast").then(n.bind(null,"4f71"))}},u=function(){var e=this,t=e.$createElement,n=(e._self._c,e.__get_style([e.inputStyle]));e.$mp.data=Object.assign({},{$root:{s0:n}})},o=[]},d832:function(e,t,n){"use strict";n.r(t);var r=n("bb36"),u=n("8eb7");for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);n("4f0f");var a,i=n("f0c5"),s=Object(i["a"])(u["default"],r["b"],r["c"],!1,null,"32451308",null,!1,r["a"],a);t["default"]=s.exports}},[["9b32","common/runtime","common/vendor"]]]);